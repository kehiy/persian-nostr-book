
# نیپ شماره 10

## رویداد های متنی و رشته ها

`پیش نویس` ‍‍`دلبخواهی`

این نیپ گونه ۱ را به عنوان یک یادداشت ساده متن معرفی میکند.

### چکیده

این نیپ توضیح میدهد که چگونه از تگ های e  و p در رویداد های متنی استفاده شود. به ویژه رویداد هایی که درپاسخ به رویداد های متنی دیگری ارسال شده اند. این به کلاینت ها کمک میکند تا پاسخ ها را در رشته ای درختی با رویداد اصلی به عنوان ریشه درخت قرار دهد.

مقدار `content` شامل متن قابل خواندن توسط انسان است.

برچسب های e و p میتوانند برای تعریف یادداشت ها رشته ها و منشن ها استفاده شوند.

نباید از زبان های نشانه گذاری مانند مارک داون و HTML استفاده شود.

### تگ e موقعیتی (منسوخ شده)

> این رویه در استفاده است اما باید به عنوان منسوخ شده در نظر گرفته شود.

["e", <event-id>, <relay-url>] همانطور که در نیپ ۱ آمده.

به طوری که:

* <event-id>: شناسه رویداد ارجاع داده شده است.
* <relay-url>: ادرس رله پیشنهادی برای رویداد ارجاع داده شده. کلاینت های زیادی این را دلبخواهی در نظر میگیرند.

موقعیت تگ e در رویداد معنا های متفاوتی دارد:

* بدون تگ e:
این رویداد یک پاسخ نیست و به رویدادی ارجاعی ندارد.

* یک تگ e:
["e", <id>]: ایدی رویدادی که این رویداد پاسخ به ان است.

* دو تگ e  ["e", <root-id>], ["e", <reply-id>]:
<root-id>: شناسه رویدادی که در ریشه زنجیره پاسخ ها قرار دارد.
<reply-id>: شناسه رویدادی که این رویداد به ان اشاره میکند.

* چند تگ e  ["e", <root-id>] ["e", <mention-id>], ..., ["e", <reply-id>]:
ممکن است هر تعداد شناسه <mention-ids> وجود داشته باشد که میتواند در زنجیره پاسخ ها باشند یا نباشند که از این رویداد استناد میکنند.  root-id و reply-id همچون موارد قبل اند.

> این روند منسوخ شده چرا که وقتی یک رویداد به رویداد دیگری ارجاع میدهد اما یک پاسخ نیست ابهاماتی پیچیده یا حتی غیرقابل حل ایجاد میکند.

### تگ e علامت گزاری شده (ترجیحی)

["e", <event-id>, <relay-url>, <marker>, <pubkey>]

به طوری که:

*<event-id>: شناسه رویداد ارجاع داده شده است.

* <relay-url>: ادرس رله پیشنهادی برای رویداد ارجاع داده شده. کلاینت باید یک ادرس معتبر قرار دهد. کلاینت ممکن است این فیلد را یک رشته خالی قرار دهد.

* <marker>: دلبخواهی است و اگر وجود داشته باشد یکی از موارد reply یا root یا mention است.

* <pubkey>: دلبخواهی است و باید شناسه مالک رویداد ارجاع شده باشد.

مواردی که با "reply" نشانه گذاری شده اند نشان دهنده شناسه رویدادی است که به آن پاسخ داده شده است. موارد نشانه گذاری شده با "root" شناسه رویداد ریشه رویدادی است که به ان پاسخ داده شده است. برای پاسخ های سطح بالا (رویداد هایی که مستقیما به ریشه اشاره میکنند.) تنها نشانه root باید استفاده شود. مواردی که با "mention" نشانه گذاری شده اند نشان دهنده شناسه یک رویداد نقل قول شده یا بازنشر شده اند.

یک پاسخ مستقیم به رویداد ریشه باید تنها یک تگ e با نشانه گذاری root داشته باشد.

> این روند ترجیح داده شده است زیرا اجازه میدهد رویداد به رویداد های دیگر اشاره کند بدون اینکه با <reply-id>  یا <root-id> اشتباه گرفته شوند.

<!-- <pubkey> باید کلید عمومی  TODO -->


### تگ p

یک فهرست است کلید های عمومی افرادی که در ریک رشته پاسخ درگیر هستند در رویداد های متنی.

زمانی که به یک رویداد پاسخ داده میشود تگ های p پاسخ برابر با تمام تگ های p خود رویداد و کلید عمومی ان رویداد است.

برای نمونه: یک رویداد متنی با مالکیت a1 با تگ های p: [p1, p2, p3] سپس تگ های p پاسخ به این رویداد باید به صورت [a1, p1, p2, p3] بدون اهمیت ترتیب باشد.
